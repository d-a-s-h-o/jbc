<html>
<head>
<title>clint_ah.html</title>
<!-- Created by Maple V Release 5, IBM INTEL NT -->
<meta name="Microsoft Theme" content="nature 100, default">
<meta name="Microsoft Border" content="tlrb, default">
</head>
<body bgcolor="#FFFFCC" text="#333399" link="#990033" vlink="#006633" alink="#FF6600"><a href="http://www.johnbcosgrave.com">	&lt; Back to johnbcosgrave.com</a><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica">

<p align="center"><font size="6"><strong></strong></font><br>
</p>
<!--mstheme--></font></td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td valign="top" width="1%"><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica">
<p>&nbsp;</p>
<!--mstheme--></font></td><td valign="top" width="24"></td><!--msnavigation--><td valign="top"><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica">
<a name="MapleAutoBookmark1">
<p align="center">
<b><u><font color="#000080" size="5">Bill Clinton, Bertie Ahern and </font></u></b>
<i><b><u><font color="#000080" size="5">digital signatures</font></u></b></i>
</p>
<p align="center">
<b><u><font color="#000080" size="4">A Public Lecture using </font></u></b>
<i><b><u><font color="#000080" size="4">MAPLE</font></u></b></i>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Date</font></u></b>
<b><font color="#000080" size="4">. </font></b>
<b><font color="#000080" size="4">               WED. 25th. Nov. 1998.</font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Venue</font></u></b>
<b><font color="#000080" size="4">.              ST. PATRICK'S COLLEGE, <br>
                         DRUMCONDRA, DUBLIN 9.</font></b>
<b><font color="#000080">                                            </font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Lecturer</font></u></b>
<b><font color="#000080">.</font></b>
<b><font color="#000080" size="4">           </font></b>
<b><font color="#000080">JOHN COSGRAVE, MATHEMATICS DEPARTMENT, </font></b>
</p>
<p align="left">
<b><font color="#000080">                                ST.  PATRICK'S COLLEGE, DRUMCONDRA,</font></b>
</p>
<p align="left">
<b><font color="#000080">                                DUBLIN 9, IRELAND. [home e-mail: johnbcos@iol.ie<br>
                                College: John.Cosgrave@spd.ie]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<i><b><u><font color="#000080" size="4">MAPLE</font></u></b></i>
<b><font color="#000080">.  </font></b>
<b><font color="#000080" size="4">         This talk has been prepared using </font></b>
<i><b><font color="#000080" size="4">MAPLE</font></b></i>
<b><font color="#000080">. </font></b>
</p>
<p align="left">
</p>
<p align="left">
<i><b><font color="#000080">MAPLE</font></b></i>
<b><font color="#000080"> is a remarkable 'Computer Algebra System', which has been in continuous development since December 1980.  Initially it was the brain-child of a dedicated group at the University of Waterloo (Canada).  It continues to be developed there, but now with the assistance of INRIA (France) and the ETH (Zurich, Switzerland). It is used here in St. Patrick's College by all first, second and third year students in our undergraduate Mathematics programme.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Some Web sites</font></u></b>
<b><font color="#000080" size="4">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">The </font></b>
<i><b><font color="#000080" size="4">MAPLE</font></b></i>
<b><font color="#000080" size="4"> </font></b>
<b><font color="#000080">home page is at: w</font></b>
<b><font color="#000080" size="4">ww.maplesoft.ca<br>
</font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="4">MAPLE</font></b></i>
<i><b><font color="#000080"> </font></b></i>
<b><font color="#000080">can be obtained from Adept Scientific at: </font></b>
<b><font color="#000080" size="4">elaine.bragg@adeptscientific.co.uk</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">There are a huge number of helpful sites; use any search engine and look up '</font></b>
<i><b><font color="#000080" size="4">Maple</font></b></i>
<b><font color="#000080" size="4">.</font></b>
<b><font color="#000080">'</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Introduction</font></u></b>
<b><font color="#000080">.  In recent years hardly a day has passed without some newspaper, magazine or journal making some reference to '</font></b>
<i><b><font color="#000080">e-commerce</font></b></i>
<b><font color="#000080">' and the associated concepts of</font></b>
</p>
<p align="left">
</p>
<p align="left">
<i><b><font color="#000080" size="4">     encryption </font></b></i>
<b><font color="#000080" size="4">(</font></b>
<i><b><font color="#000080" size="4">public-key</font></b></i>
<b><font color="#000080" size="4">)</font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="4">     decryption</font></b></i>
<i><b><font color="#000080"> </font></b></i>
<b><font color="#000080" size="4">(</font></b>
<i><b><font color="#000080" size="4">private-key</font></b></i>
<b><font color="#000080" size="4">)</font></b>
<b><font color="#000080"> and </font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="4">     secure digital </font></b></i>
<i><b><font color="#000080" size="4">signatures</font></b></i>
<b><font color="#000080"> <br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">in short, the whole paraphernalia of modern (</font></b>
<i><b><font color="#000080">i.e.</font></b></i>
<b><font color="#000080"> post 1977) public-key cryptography.  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">[For a </font></b>
<b><u><font color="#000080">history of Cryptography</font></u></b>
<b><font color="#000080"> see the outstanding (1181 page) reference: </font></b>
<i><b><u><font color="#000080" size="4">The Codebreakers</font></u></b></i>
<b><font color="#000080"> (The Comprehensive History of Secret Communication from Ancient Times to the Internet) by </font></b>
<b><u><font color="#000080">David Kahn</font></u></b>
<b><font color="#000080">, published by </font></b>
<i><b><u><font color="#000080" size="4">SCRIBNER</font></u></b></i>
<b><font color="#000080">, 1996 (2nd. new edition)  </font></b>
<b><u><font color="#000080">ISBN 0-684-83130-9</font></u></b>
<b><font color="#000080"> ]</font></b>
</p>
<p align="left">
<b><font color="#000080" size="4"><br>
                                     </font></b>
<b><u><font color="#000080" size="5">My lecture in a nutshell</font></u></b>
<b><font color="#000080" size="5">. </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">&quot;Ahern to seal historic digital accord with Clinton&quot;, and &quot;Digital history made in Dublin&quot; - Irish Times, Sept. 1st. and 5th. On Sept. 4th. Bill<br>
Clinton and Bertie Ahern 'digitally signed' a US-Irish government communiqué on e-commerce, using cryptographic software produced by Baltimore Technologies (see </font></b>
<i><b><font color="#000080">www.baltimore.ie</font></b></i>
<b><font color="#000080"> for a picture of the signing ceremony, and the government communique). [Mr. Ahern - the Irish Prime Minister - is our neighbour here in Drumcondra, and as a boy went to the primary school in the College grounds.]<br>
<br>
</font></b>
<b><u><font color="#000080" size="4">What is a digital signature?</font></u></b>
<b><font color="#000080">  It is a mathematically driven electronic form of a classical signature, a </font></b>
<b><u><font color="#000080">revolutionary development</font></u></b>
<b><font color="#000080"> made possible<br>
through the creation of </font></b>
<b><u><font color="#000080">'public-key' cryptography</font></u></b>
<b><font color="#000080">. </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">How does 'public-key' cryptography work?</font></u></b>
<b><font color="#000080">  Here is a </font></b>
<b><u><font color="#000080">highly</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">idealised</font></u></b>
<b><font color="#000080"> picture which captures </font></b>
<b><u><font color="#000080">the essential idea</font></u></b>
<b><font color="#000080">:  imagine I have paints</font></b>
</p>
<p align="left">
<b><font color="#000080"> </font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="5">public1</font></b></i>
<b><font color="#000080"> (available to </font></b>
<i><b><font color="#000080">anyone</font></b></i>
<b><font color="#000080">.  'Anyone' in the sense that I don't care who has access to it) and </font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080"> (available </font></b>
<i><b><font color="#000080">only to me</font></b></i>
<b><font color="#000080">), with these properties:<br>
<br>
1.   a surface painted with  </font></b>
<i><b><font color="#000080" size="5">public1</font></b></i>
<b><font color="#000080"> (disguising the surface), and subsequently with  </font></b>
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080">, restores the original surface,<br>
<br>
2.  a surface painted with  </font></b>
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080"> (disguising the surface), and subsequently with</font></b>
<i><b><font color="#000080" size="5"> public1</font></b></i>
<b><font color="#000080">, restores the original surface,<br>
<br>
3.  no one can realistically manufacture  </font></b>
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080"> from  </font></b>
<i><b><font color="#000080" size="5">public1</font></b></i>
<b><font color="#000080">.<br>
</font></b>
</p>
<p align="left">
<b><u><font color="#000080">You then communicate with me by</font></u></b>
<b><font color="#000080"> writing your message on a surface, paint over with  </font></b>
<i><b><font color="#000080" size="5">public1</font></b></i>
<b><font color="#000080">, and send the painted surface to me. On receipt, by painting over with  </font></b>
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080">, I recover your message. Can I have confidence the message came from you?  I can't!!  The message could be from someone impersonating you.<br>
<br>
</font></b>
<b><u><font color="#000080" size="4">This is the solution</font></u></b>
<b><font color="#000080">.  Suppose you have paints </font></b>
<i><b><font color="#000080" size="5">public2</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080" size="5">private2</font></b></i>
<b><font color="#000080">, with properties similar to  </font></b>
<i><b><font color="#000080" size="5">public1</font></b></i>
<b><font color="#000080"> and  </font></b>
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080">.  Write your message on a surface, and apply two </font></b>
<b><u><font color="#000080">disguising</font></u></b>
<b><font color="#000080"> coats of paints: </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">first with </font></b>
<b><u><font color="#000080">your</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">secret</font></u></b>
<b><font color="#000080"> </font></b>
<i><b><font color="#000080" size="5">private2</font></b></i>
<b><font color="#000080">, </font></b>
</p>
<p align="left">
<b><font color="#000080">then with </font></b>
<b><u><font color="#000080">my</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080">  </font></b>
<i><b><font color="#000080" size="5">public1</font></b></i>
<b><font color="#000080">. <br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">On receipt of the doubly-disguised surface I apply two </font></b>
<b><u><font color="#000080">revealing</font></u></b>
<b><font color="#000080"> coats of paint: </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">first with </font></b>
<b><u><font color="#000080">my</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">secret</font></u></b>
<b><font color="#000080">  </font></b>
<i><b><font color="#000080" size="5">private1</font></b></i>
<b><font color="#000080"> (stripping off the top layer),</font></b>
</p>
<p align="left">
<b><font color="#000080">then with </font></b>
<b><u><font color="#000080">your</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080"> </font></b>
<i><b><font color="#000080" size="5">public2</font></b></i>
<b><font color="#000080">, revealing the original message which I know must have come from you.<br>
</font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">This highly fanciful idea has, however, been made a reality</font></u></b>
<b><font color="#000080" size="4">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Classical (pre 1976) cryptography</font></b>
<font color="#000080"> </font>
<b><font color="#000080">(</font></b>
<i><b><font color="#000080">kryptos </font></b></i>
<b><font color="#000080">logos</font></b>
<i><b><font color="#000080"> = hidden</font></b></i>
<b><font color="#000080"> word) was about devising means of disguising messages so that the recipient of the </font></b>
</p>
<p align="left">
<b><font color="#000080">message was privy to HOW the message was disguised, and thus - by </font></b>
<b><u><font color="#000080">reversing the process</font></u></b>
<b><font color="#000080"> - could recover the original message</font></b>
<b><font color="#000080" size="4">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">The archetypal example was the </font></b>
<i><b><font color="#000080">Caesar code</font></b></i>
<b><font color="#000080">, whereby the message was disguised by 'transposition by 3', a posh way of saying 'move every </font></b>
</p>
<p align="left">
<b><font color="#000080">letter </font></b>
<b><u><font color="#000080">along</font></u></b>
<b><font color="#000080"> three places.' Thus - for example - </font></b>
<i><b><font color="#000080">' cat</font></b></i>
<b><font color="#000080"> ' would become '</font></b>
<i><b><font color="#000080"> fdw</font></b></i>
<b><font color="#000080"> ', and the recipient would recover </font></b>
<i><b><font color="#000080">cat</font></b></i>
<b><font color="#000080"> from </font></b>
<i><b><font color="#000080">fwd</font></b></i>
<b><font color="#000080"> by moving every letter </font></b>
<b><u><font color="#000080">back</font></u></b>
<b><font color="#000080"> </font></b>
</p>
<p align="left">
<b><font color="#000080">three places</font></b>
<b><font color="#000080" size="4">.<br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">Later methods were far, far more complex, but nevertheless the fact remained that until about 1977 all cryptographic methods were such that if one knew HOW a message was encrypted then one could easily decrypt it</font></b>
<b><font color="#000080" size="4">.</font></b>
</p>
<p align="left">
<b><font color="#000080" size="4"><br>
</font></b>
<b><font color="#000080">The REVOLUTION brought about in 1976 in a paper</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080" size="4">'The fundamental idea of public-key cryptography' (</font></b>
<b><u><font color="#000080" size="4">Diffie and Hellman, 1976</font></u></b>
<b><font color="#000080" size="4">), </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">      [in which one might say they proposed </font></b>
<i><b><font color="#000080">the idea</font></b></i>
<b><font color="#000080"> of the paints] and in 1977 in another paper</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080" size="4">'The realization of public-key cryptography'</font></b>
<b><font color="#000080"> </font></b>
<b><font color="#000080" size="4">(</font></b>
<b><u><font color="#000080" size="4">Rivest, Shamir and Adleman, 1977</font></u></b>
<b><font color="#000080" size="4">)</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">       [in which one might say they showed </font></b>
<i><b><font color="#000080">how to make them</font></b></i>
<b><font color="#000080">]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">was that one could now have methods of disguise which were of </font></b>
<b><u><font color="#000080">such a nature</font></u></b>
<b><font color="#000080"> that EVEN IF ONE KNEW HOW THE MESSAGE WAS '</font></b>
<i><b><font color="#000080">ENCRYPTED</font></b></i>
<b><font color="#000080">' (</font></b>
<i><b><font color="#000080">i</font></b></i>
<b><font color="#000080">.</font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080">. disguised) ONE COULD NOT '</font></b>
<i><b><font color="#000080">DECRYPT</font></b></i>
<b><font color="#000080"> ' (</font></b>
<i><b><font color="#000080">i.e.</font></b></i>
<b><font color="#000080"> unscramble) IT IN ANY REASONABLE PERIOD OF TIME (MANY THOUSANDS OF YEARS, SAY)</font></b>
<b><font color="#000080" size="4">.<br>
<br>
</font></b>
<b><font color="#000080">The </font></b>
<b><u><font color="#000080">key</font></u></b>
<b><font color="#000080"> to this development - in a nutshell - was to devise 'trapdoor' methods:  methods which were intrinsically difficult to reverse (it is easy to fall through a trapdoor, but difficult to get out of it)</font></b>
<b><font color="#000080" size="4">.<br>
<br>
Keep your eye open for this </font></b>
<i><b><font color="#000080" size="4">difficulty of reversal</font></b></i>
<b><font color="#000080" size="4"> as my talk proceeds.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">                  </font></b>
<b><u><font color="#000080" size="5">Structure of the rest of my talk</font></u></b>
</p>
<p align="left">
<b><font color="#000080"><br>
</font></b>
<b><u><font color="#000080" size="4">Section One</font></u></b>
<b><font color="#000080" size="4">. A romp through </font></b>
<i><b><u><font color="#000080" size="4">public-key cryptography</font></u></b></i>
<b><font color="#000080" size="4">, using the revolutionary </font></b>
<i><b><u><font color="#000080" size="4">RSA method</font></u></b></i>
<b><font color="#000080" size="4">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Section Two</font></u></b>
<b><font color="#000080" size="4">.  How the the </font></b>
<i><b><font color="#000080" size="4">RSA</font></b></i>
<b><font color="#000080" size="4"> method is used to provide a '</font></b>
<i><b><u><font color="#000080" size="4">digital signature</font></u></b></i>
<b><font color="#000080" size="4">.'</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Section Three</font></u></b>
<b><font color="#000080" size="4">. The '</font></b>
<i><b><font color="#000080" size="4">factorization problem</font></b></i>
<b><font color="#000080" size="4">.'</font></b>
<b><font color="#000080"> </font></b>
<b><font color="#000080" size="4">[the '</font></b>
<i><b><font color="#000080" size="4">trapdoor</font></b></i>
<b><font color="#000080" size="4">.']</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Section One</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">First</font></u></b>
<b><font color="#000080"> we need to make a </font></b>
<b><u><font color="#000080">convention</font></u></b>
<b><font color="#000080"> as to an ordering of our </font></b>
<i><b><font color="#000080">alphabetic symbols </font></b></i>
<b><font color="#000080">('a' followed by 'b', 'b' by 'c', </font></b>
<i><b><font color="#000080">etc.</font></b></i>
<b><font color="#000080">):</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">`crypt/alphabet` := <br>
   `abcdefghijklmnopqrstuvwxyz`<br>
   .`ABCDEFGHIJKLMNOPQRSTUVWXYZ`<br>
   .```1234567890-=~!@#$£%^&amp;*()_+`<br>
   .` ,./&lt;&gt;?;':&quot;[]{}|    `:</font></b>
</p>
<p align="left">
<b><u><font color="#000080">Next</font></u></b>
<b><font color="#000080"> we need a procedure to </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080" size="4">          </font></b>
<b><u><font color="#000080" size="4">turn a string of text into a number</font></u></b>
<b><font color="#000080" size="4">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">to_number := proc(st, string) <br>
local ll, nn, ss, ii;  <br>
ll := length(st);<br>
if ll = 0 then RETURN(0) fi; <br>
nn := 1; for ii to ll do <br>
ss := SearchText(substring(st, ii .. ii),<br>
                 `crypt/alphabet`);<br>
nn := 100*nn + ss od; nn - 10^(2*ll) <br>
end:</font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Some examples</font></u></b>
<b><font color="#000080" size="4"> (</font></b>
<b><u><font color="#000080" size="4">Note</font></u></b>
<b><font color="#000080" size="4"> to anyone trying this: the text </font></b>
<b><u><font color="#000080" size="4">must</font></u></b>
<b><font color="#000080" size="4"> be included within </font></b>
<i><b><font color="#000080" size="4">backward quotes</font></b></i>
<b><font color="#000080" size="4">, namely ``).</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">to_number(`This is great!!!`);  # Example 1</font></b>
</p>
<p align="center">
<img src="images/clint_ah1.gif" width="272" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Observation</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">The initial '46' represents the 'T' in 'This, </font></b>
</p>
<p align="left">
<b><font color="#000080">the following '08' represents the 'h' in 'This',<br>
   .<br>
   .</font></b>
</p>
<p align="left">
<b><font color="#000080">the final '676767' corresponds to the '!!!' at the end.<br>
</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">to_number(`Lmsaus woutfger &amp;8^%ysph ;;; 23$££!+=plas`);  # Example 2</font></b>
</p>
<p align="center">
<img src="images/clint_ah2.gif" width="672" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Comment</font></u></b>
<b><font color="#000080">.  Junk text will still have a numerical representation.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Finally</font></u></b>
<b><font color="#000080"> we need a procedure to </font></b>
<b><u><font color="#000080" size="4">recover a string of text from a number</font></u></b>
<b><font color="#000080" size="4"><br>
</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number := proc(nn, integer) <br>
local ss, mm, ll, pp, ii, ans; mm := nn;<br>
ll := floor(1/2*trunc(evalf(log10(mm))))+1;<br>
ans := ``; for ii to ll do mm := mm/100;<br>
pp := 100*frac(mm);<br>
ss := substring(`crypt/alphabet`, pp..pp);<br>
ans := cat(ss, ans); mm := trunc(mm)<br>
od; ans end:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Some examples</font></u></b>
<b><font color="#000080" size="4">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number(90271404803580011380091480040519160109188020080120802009130580130125800218091407802716161815220504801601202005181419801506802315130514801518801506801305148028212080141520802008012080190512061901130580052403051212051403058001070109148290);</font></b>
</p>
<p align="center">
<img src="images/clint_ah3.gif" width="826" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number(11223344553476800987127834557698798765497059236721694654300987766554443336);</font></b>
</p>
<p align="center">
<img src="images/clint_ah4.gif" width="314" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number(46080919800919800180071805012080120503202118056767803015802515211880192021040514201980121515118006151823011804802015800715091407802015802008050918801805072112011880120503202118051986);</font></b>
</p>
<p align="center">
<img src="images/clint_ah5.gif" width="606" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">A message from the students: 40416767 ... 67</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Let's see what it is:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number(4041676767676767676767676767676767);</font></b>
</p>
<p align="center">
<img src="images/clint_ah6.gif" width="115" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Now for a crash course on </font></u></b>
<i><b><u><font color="#000080" size="4">RSA</font></u></b></i>
<b><u><font color="#000080" size="4"> </font></u></b>
<i><b><u><font color="#000080" size="4">public-key cryptography, </font></u></b></i>
<b><u><font color="#000080" size="4">in which I cut some corners, but make an effort to point out when I am doing so.</font></u></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">One frequently reads that RSA public-key cryptography is about choosing:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">two </font></b>
<b><u><font color="#000080" size="5">'big'</font></u></b>
<b><font color="#000080"> primes - ' </font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> ' and ' </font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> '- and multiplying them together, forming the number ' </font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080"> ' - one of the two elements of the ' </font></b>
<i><b><u><font color="#000080">public</font></u></b></i>
<i><b><font color="#000080">-key</font></b></i>
<b><font color="#000080"> ' [this is indeed part of the truth, but is not the entire truth. A certain </font></b>
<b><u><font color="#000080">care</font></u></b>
<b><font color="#000080"> - in the 'real world' - must be exercised in choosing these two primes.  It all relates to the fundamentally difficult '</font></b>
<i><b><font color="#000080">factorization problem</font></b></i>
<b><font color="#000080">' ... ].<br>
<br>
and that one then creates </font></b>
<b><u><font color="#000080">two further numbers</font></u></b>
<b><font color="#000080">:<br>
</font></b>
</p>
<p align="left">
<b><font color="#000080"> '</font></b>
<i><b><font color="#000080"> e</font></b></i>
<b><font color="#000080"> ' - the ' </font></b>
<i><b><u><font color="#000080">public</font></u></b></i>
<i><b><font color="#000080"> encryption power </font></b></i>
<b><font color="#000080">', and the second element of the ' </font></b>
<i><b><font color="#000080">public-key</font></b></i>
<b><font color="#000080"> ' <br>
<br>
[ </font></b>
<b><u><font color="#000080">the fine mathematical detail requires</font></u></b>
<b><font color="#000080"> that this </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080">, and the number (</font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> - 1) times (</font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> - 1), are </font></b>
<b><u><font color="#000080">not both divisible</font></u></b>
<b><font color="#000080"> by some common whole <br>
  number, </font></b>
<b><u><font color="#000080">greater than 1</font></u></b>
<b><font color="#000080">.  That '(</font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> - 1) times (</font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> </font></b>
<b><font color="#000080">- 1)' is known as the ' </font></b>
<i><b><font color="#000080">phi-value</font></b></i>
<b><font color="#000080"> ' of the number </font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">, and it was introduced into Mathematics by the  renowned 18th. century mathematician, Euler.<br>
<br>
 Thus - </font></b>
<b><u><font color="#000080">for example</font></u></b>
<b><font color="#000080"> - to take </font></b>
<b><u><font color="#000080">small illustrative (only) values</font></u></b>
<b><font color="#000080">:<br>
<br>
  if </font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> was </font></b>
<b><u><font color="#000080">5</font></u></b>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> was </font></b>
<b><u><font color="#000080">11</font></u></b>
<b><font color="#000080">, then </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">could</font></u></b>
<b><font color="#000080"> be chosen to be </font></b>
<b><u><font color="#000080">3</font></u></b>
<b><font color="#000080">, because </font></b>
<b><u><font color="#000080">3</font></u></b>
<b><font color="#000080"> and  (</font></b>
<b><u><font color="#000080">5</font></u></b>
<b><font color="#000080"> - 1) times (</font></b>
<b><u><font color="#000080">11</font></u></b>
<b><font color="#000080"> - 1) (namely 40) are not both divisible by any <br>
  common whole number greater than 1, whereas </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080"> could </font></b>
<b><u><font color="#000080">not</font></u></b>
<b><font color="#000080"> be chosen to be - say - 6, since 6 and 40 are both divisible by 2. ]<br>
 </font></b>
</p>
<p align="left">
<b><font color="#000080">'</font></b>
<i><b><font color="#000080"> d</font></b></i>
<b><font color="#000080"> ' - the '</font></b>
<b><font color="#000080"> private decryption power</font></b>
<b><font color="#000080"> ' <br>
<br>
[ </font></b>
<b><u><font color="#000080">the fine mathematical detail requires</font></u></b>
<b><font color="#000080"> that the </font></b>
<b><u><font color="#000080">product</font></u></b>
<b><font color="#000080"> of the numbers </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080"> be a multiple of the number (</font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> - 1) times (</font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> - 1), plus 1.<br>
<br>
 Thus - for example - and using the above values </font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> = 5, </font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> = 11, and </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080"> = 3, </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">could be chosen to be</font></u></b>
<b><font color="#000080"> 27 since 3 times 27 (namely 81)<br>
  is a multiple of 40, plus 1 (namely 2 times 40, plus 1). ] <br>
</font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Some brief, passing mathematical notes</font></u></b>
<b><font color="#000080" size="4">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Recall that a '</font></b>
<i><b><u><font color="#000080">prime</font></u></b></i>
<b><font color="#000080">' number is a whole number which is greater than 1, and which is </font></b>
<b><u><font color="#000080">evenly divisible only by 1 and itself</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">A few computations</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">with(numtheory):</font></b>
</p>
<p align="left">
<b><tt><!--mstheme--></font><pre><font color="#0000FF" size="4">Warning, new definition for order</font></pre><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica"></tt></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">divisors(17);  # 17 is a prime number:</font></b>
</p>
<p align="center">
<img src="images/clint_ah7.gif" width="64" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">divisors(15);  # 15 isn't a prime number:</font></b>
</p>
<p align="center">
<img src="images/clint_ah8.gif" width="96" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">divisors(123454321);</font></b>
</p>
<p align="center">
<img src="images/clint_ah9.gif" width="432" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">divisors(2^13 - 1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah10.gif" width="80" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">divisors(2^23 + 1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah11.gif" width="184" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Here are the first 200 primes</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">seq(ithprime(k), k=1..200);</font></b>
</p>
<p align="left">
<img src="images/clint_ah12.gif" width="964" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah13.gif" width="972" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah14.gif" width="972" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah15.gif" width="972" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah16.gif" width="972" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah17.gif" width="964" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah18.gif" width="688" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Here is the 1000-th. prime number</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ithprime(1000);</font></b>
</p>
<p align="center">
<img src="images/clint_ah19.gif" width="48" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Here is the next prime after the number 20</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">nextprime(20);</font></b>
</p>
<p align="center">
<img src="images/clint_ah20.gif" width="32" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">and here - </font></b>
<b><u><font color="#000080">much more spectacularly</font></u></b>
<b><font color="#000080"> - is the next prime after the (randomly-typed) number 9998777553210032992874366465554431:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">nextprime(9998777553210032992874366465554431);</font></b>
</p>
<p align="center">
<img src="images/clint_ah21.gif" width="288" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Remark</font></u></b>
<b><font color="#000080">. There is a lot of serious Mathematics going on behind the scenes in making that extremely fast computation ... !!!</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Returning to RSA cryptography:</font></u></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080" size="4">The (</font></b>
<i><b><font color="#000080" size="4">n</font></b></i>
<b><font color="#000080" size="4">, </font></b>
<i><b><font color="#000080" size="4">e</font></b></i>
<b><font color="#000080" size="4">) pair form the ' </font></b>
<i><b><u><font color="#000080" size="4">public-key</font></u></b></i>
<i><b><font color="#000080" size="4"> </font></b></i>
<b><font color="#000080" size="4">' (the public paint, as it were) and <br>
</font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="4">d</font></b></i>
<b><font color="#000080" size="4"> is the ' </font></b>
<i><b><u><font color="#000080" size="4">private-key</font></u></b></i>
<b><font color="#000080" size="4"> ' (the private paint, as it were)</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">I will create </font></b>
<b><u><font color="#000080">public and private keys</font></u></b>
<b><font color="#000080"> for myself (John = </font></b>
<i><b><font color="#000080" size="4">j</font></b></i>
<b><font color="#000080">), and will use:</font></b>
</p>
<p align="left">
<b><font color="#000080"> </font></b>
</p>
<p align="left">
<i><b><font color="#000080" size="4">pj</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080" size="4">qj</font></b></i>
<b><font color="#000080"> to denote </font></b>
<b><u><font color="#000080">my two chosen primes</font></u></b>
</p>
<p align="left">
<i><b><font color="#000080" size="4">nj</font></b></i>
<b><font color="#000080"> - my '</font></b>
<i><b><u><font color="#000080">public modulus</font></u></b></i>
<b><font color="#000080">' - the product of </font></b>
<i><b><font color="#000080" size="4">pj</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080" size="4">qj</font></b></i>
</p>
<p align="left">
<i><b><font color="#000080" size="4">ej</font></b></i>
<b><font color="#000080"> to denote </font></b>
<b><u><font color="#000080">my </font></u></b>
<i><b><u><font color="#000080">public encryption power</font></u></b></i>
</p>
<p align="left">
<i><b><font color="#000080" size="4">dj</font></b></i>
<b><font color="#000080"> to denote </font></b>
<b><u><font color="#000080">my </font></u></b>
<i><b><u><font color="#000080">private decryption power</font></u></b></i>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">First my two </font></u></b>
<i><b><u><font color="#000080">secret </font></u></b></i>
<b><u><font color="#000080">primes</font></u></b>
<b><font color="#000080"> (to keep matters </font></b>
<b><u><font color="#000080">simple</font></u></b>
<b><font color="#000080"> I am </font></b>
<b><u><font color="#000080">not</font></u></b>
<b><font color="#000080"> exercising </font></b>
<b><u><font color="#000080">care</font></u></b>
<b><font color="#000080"> with respect to their choice):</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">pj := nextprime(10^49 + 654321);  # 50 digit prime</font></b>
</p>
<p align="center">
<img src="images/clint_ah22.gif" width="450" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">qj := nextprime(10^69 + 654321654321);  # 70 digit prime</font></b>
</p>
<p align="center">
<img src="images/clint_ah23.gif" width="610" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Next, my public modulus</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">nj := pj*qj; # the product of my secretly chosen primes</font></b>
</p>
<p align="left">
<img src="images/clint_ah24.gif" width="51" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah25.gif" width="968" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Next, to choose my public encryption power ' </font></u></b>
<i><b><u><font color="#000080">ej</font></u></b></i>
<b><u><font color="#000080"> '.</font></u></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Recall from earlier that this </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">must be chosen</font></u></b>
<b><font color="#000080"> so as to satisfy the </font></b>
<b><u><font color="#000080">requirement</font></u></b>
<b><font color="#000080"> that </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080"> and (</font></b>
<i><b><font color="#000080">pj</font></b></i>
<b><font color="#000080"> - 1) times (</font></b>
<i><b><font color="#000080">qj</font></b></i>
<b><font color="#000080"> - 1) are not both divisible by some common whole number greater than 1.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Anyone familiar with the mathematics at stake here would know that one has a very high chance of a successful choice if one chooses </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080"> to be a reasonably-sized, randomly-chosen prime.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">I make an attempt with</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ej := nextprime(1234321); </font></b>
</p>
<p align="center">
<img src="images/clint_ah26.gif" width="105" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Now I need to test that it satisfies the above requirement.</font></u></b>
<b><font color="#000080"> That requires two steps:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">First</font></u></b>
<b><font color="#000080"> I need to calculate the Euler </font></b>
<i><b><font color="#000080">phi-value</font></b></i>
<b><font color="#000080"> of my </font></b>
<i><b><font color="#000080">nj</font></b></i>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">phi_nj := (pj - 1)*(qj - 1);</font></b>
</p>
<p align="left">
<img src="images/clint_ah27.gif" width="81" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah28.gif" width="968" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
</p>
<p align="left">
<b><u><font color="#000080">Second</font></u></b>
<b><font color="#000080"> I must test to see that there is no whole number greater than 1 that divides both </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080">phi_nj</font></b></i>
<b><font color="#000080">.  That is achieved by using a </font></b>
<b><u><font color="#000080">remarkable idea</font></u></b>
<b><font color="#000080"> - known as the</font></b>
<i><b><font color="#000080"> Euclidean algorithm</font></b></i>
<b><font color="#000080"> - that has come down to us from the renowned 3rd. century B.C. Greek mathematician, </font></b>
<b><u><font color="#000080">Euclid</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">The mathematics is </font></b>
<b><u><font color="#000080">hidden</font></u></b>
<b><font color="#000080"> behind the following:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcd(ej, phi_nj);</font></b>
</p>
<p align="center">
<img src="images/clint_ah29.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080" size="4">A brief mathematical note</font></u></b>
<b><font color="#000080" size="4">. That '1' tells us that 1 </font></b>
<b><u><font color="#000080" size="4">is</font></u></b>
<b><font color="#000080" size="4"> the 'greatest common divisor' of </font></b>
<i><b><font color="#000080" size="4">ej</font></b></i>
<b><font color="#000080" size="4"> and </font></b>
<i><b><font color="#000080" size="4">phi_nj</font></b></i>
<b><font color="#000080" size="4">, and so there is no whole number greater than 1 which divides both </font></b>
<i><b><font color="#000080" size="4">ej</font></b></i>
<b><font color="#000080" size="4"> and </font></b>
<i><b><font color="#000080" size="4">phi_nj</font></b></i>
<b><font color="#000080" size="4">. </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Here are a few smaller illustrative examples</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcd(18, 14);</font></b>
</p>
<p align="center">
<img src="images/clint_ah30.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcd(15, 21);</font></b>
</p>
<p align="center">
<img src="images/clint_ah31.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcd(35, 27);</font></b>
</p>
<p align="center">
<img src="images/clint_ah32.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Next, to choose my private decryption power '</font></b>
<i><b><u><font color="#000080"> dj </font></u></b></i>
<b><u><font color="#000080">'</font></u></b>
<i><b><font color="#000080">.</font></b></i>
<b><font color="#000080"><br>
<br>
Recall that that </font></b>
<b><u><font color="#000080">requires</font></u></b>
<b><font color="#000080"> that </font></b>
<i><b><font color="#000080">dj</font></b></i>
<b><font color="#000080"> have the </font></b>
<b><u><font color="#000080">property</font></u></b>
<b><font color="#000080"> that the product of </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080">dj</font></b></i>
<b><font color="#000080"> be a multiple of </font></b>
<i><b><font color="#000080">phi_nj</font></b></i>
<b><font color="#000080">, plus 1.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">The computation of </font></b>
<i><b><font color="#000080">dj</font></b></i>
<b><font color="#000080"> is done by using a remarkable consequence of the Euclidean algorithm - namely the </font></b>
<i><b><font color="#000080">extended Euclidean Algorithm</font></b></i>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">The mathematics is hidden behind the following </font></u></b>
<b><u><font color="#000080">two calculations</font></u></b>
<b><u><font color="#000080">:</font></u></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcdex(ej, phi_nj, xj, yj);</font></b>
</p>
<p align="center">
<img src="images/clint_ah33.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">dj := xj mod phi_nj; </font></b>
</p>
<p align="left">
<img src="images/clint_ah34.gif" width="50" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah35.gif" width="960" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Thus, my </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> decryption power is the (enormous) number 828349 ... ... ... 181697.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080" size="4">It is something of a </font></b>
<i><b><font color="#000080" size="4">needle in a haystack</font></b></i>
<b><font color="#000080" size="4">!!!</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">In fact, it is the </font></b>
<b><u><font color="#000080">only</font></u></b>
<b><font color="#000080"> number between 1 and </font></b>
<i><b><font color="#000080">phi_nj</font></b></i>
<b><font color="#000080"> with the </font></b>
<b><u><font color="#000080">required property</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Making my public keys known (to the world at large)</font></u></b>
<b><font color="#000080">, I am now set up to </font></b>
<b><u><font color="#000080">receive</font></u></b>
<b><font color="#000080"> messages from anyone who knows my public keys, and also to </font></b>
<b><u><font color="#000080">send</font></u></b>
<b><font color="#000080"> messages messages to anyone who knows my public keys.  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">For example</font></u></b>
<b><font color="#000080">, let's say that you (Mary) wished to send me this message, </font></b>
<b><u><font color="#000080">using my public keys</font></u></b>
<b><font color="#000080"> (it being understood, of course, that we are also using the agreed 'crypt/alphabet'):  </font></b>
<b><font color="#000080" size="5">Meet at cinema, 9.30 P.M. Mary</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">You - Mary - would do this</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">First</font></u></b>
<b><font color="#000080"> convert your message into numerical form, using the to_number procedure:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">num1 := to_number(`Meet at cinema, 9.30 P.M. Mary`);</font></b>
</p>
<p align="center">
<img src="images/clint_ah36.gif" width="556" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Next</font></u></b>
<b><font color="#000080"> you perform a </font></b>
<b><u><font color="#000080">single encryption</font></u></b>
<b><font color="#000080"> [you are laying one coat of paint] using my </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080"> encryption power </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080">, and my </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080"> modulus </font></b>
<i><b><font color="#000080">nj</font></b></i>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">That involves:<br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">raising the number ' </font></b>
<i><b><font color="#000080">num1</font></b></i>
<b><font color="#000080"> ' to the power of the number </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080">, and then </font></b>
</p>
<p align="left">
<b><font color="#000080">calculating the remainder on division by </font></b>
<i><b><font color="#000080">nj</font></b></i>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">That is an </font></b>
<i><b><font color="#000080">extraordinary computational feat</font></b></i>
<b><font color="#000080">, and it exploits a fundamental mathematical construct known as </font></b>
<i><b><font color="#000080">modular exponentiation</font></b></i>
<b><font color="#000080">, using the </font></b>
<i><b><font color="#000080">square-and-multiply </font></b></i>
<b><font color="#000080">technique.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">The mathematics is hidden in the following - incredibly fast - calculation</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">enc1 := num1&amp;^ej mod nj;</font></b>
</p>
<p align="left">
<img src="images/clint_ah37.gif" width="69" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah38.gif" width="960" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">You send me that number</font></u></b>
<b><font color="#000080"> - enc1 - the encrypted form of the (ordinary) numerical form of the message, and then I proceed to decrypt that by using my </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> decryption power </font></b>
<i><b><font color="#000080">dj.</font></b></i>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">That also entails a modular exponentiation computation [it is actually the application of the private coat of paint], whereby the original numerical form of the text is </font></b>
<b><u><font color="#000080">recovered</font></u></b>
<b><font color="#000080"> by raising the numerical form of the encrypted text to the power of the decryption power </font></b>
<i><b><font color="#000080">dj</font></b></i>
<b><font color="#000080">, and calculating the remainder on division by </font></b>
<i><b><font color="#000080">nj:</font></b></i>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">dec1 := enc1&amp;^dj mod nj;</font></b>
</p>
<p align="center">
<img src="images/clint_ah39.gif" width="548" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Then I recover the original message by</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">text1 := from_number(dec1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah40.gif" width="281" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Horrah!! All </font></b>
<b><u><font color="#000080">SEEMS</font></u></b>
<b><font color="#000080"> fine. You have sent me an encrypted message, and I have decrypted it.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">But </font></b>
<b><u><font color="#000080">why</font></u></b>
<b><font color="#000080"> '</font></b>
<i><b><font color="#000080">seems</font></b></i>
<b><font color="#000080">'?  [This brings us to the </font></b>
<i><b><u><font color="#000080" size="4">crux</font></u></b></i>
<b><font color="#000080"> of the matter.] </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Well, you have used my public key to send me that message, </font></b>
<b><u><font color="#000080">BUT</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">anyone</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">could</font></u></b>
<b><font color="#000080"> have sent me that message.  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Anyone, that is, who knows my public key</font></u></b>
<b><font color="#000080">. </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">'</font></b>
<b><u><font color="#000080">You</font></u></b>
<b><font color="#000080">' </font></b>
<b><u><font color="#000080">could be someone else</font></u></b>
<b><font color="#000080"> ... .</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">[I'm not finished yet with the points I wish to make ... .]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Equally I could send you a message.  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">I could do it by using </font></b>
<b><u><font color="#000080">your public key</font></u></b>
<b><font color="#000080"> (if you had one which I knew), </font></b>
<b><u><font color="#000080">BUT</font></u></b>
<b><font color="#000080"> 'I' also could be someone else ... . </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">[I'm still not finished with the points I wish to make ... .]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">I </font></b>
<b><u><font color="#000080">could</font></u></b>
<b><font color="#000080"> send you a message using my own </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> key (</font></b>
<b><u><font color="#000080">assuming</font></u></b>
<b><font color="#000080"> you know my public key), and I could do that </font></b>
<b><u><font color="#000080">NOT</font></u></b>
<b><font color="#000080"> by encrypting using my public encryption power (which anyway would require that you knew my private decryption power), </font></b>
<b><u><font color="#000080">BUT</font></u></b>
<b><font color="#000080"> by encrypting using my own </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> decryption power to encrypt.  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">For example</font></u></b>
<b><font color="#000080">, suppose I want to send you (Mary) the message: </font></b>
<b><font color="#000080" size="5">Can't make it. Too much work. John</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">[My wife would confirm that this is all too realistic an example.]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">First I convert my message into numerical form, using the to_number procedure:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">num2 := to_number(`Can't make it. Too much work. John`);</font></b>
</p>
<p align="center">
<img src="images/clint_ah41.gif" width="620" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Next</font></u></b>
<b><font color="#000080"> I perform a </font></b>
<b><u><font color="#000080">single encryption</font></u></b>
<b><font color="#000080">,  </font></b>
<b><u><font color="#000080">BUT</font></u></b>
<b><font color="#000080"> using my </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> decryption power dj, and my </font></b>
<i><b><font color="#000080">public</font></b></i>
<b><font color="#000080"> modulus </font></b>
<i><b><font color="#000080">nj:</font></b></i>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">enc2 := num2&amp;^dj mod nj; </font></b>
</p>
<p align="left">
<img src="images/clint_ah42.gif" width="69" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah43.gif" width="960" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">I send you that number - enc2 - the encrypted form of the (ordinary) numerical form of the message, and then </font></b>
<b><u><font color="#000080">you</font></u></b>
<b><font color="#000080"> then proceed to decrypt that by using my </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080"> encryption power </font></b>
<i><b><font color="#000080">ej</font></b></i>
<b><font color="#000080"> [the paints have interchangeable properties]:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">dec2 := enc2&amp;^ej mod nj;</font></b>
</p>
<p align="center">
<img src="images/clint_ah44.gif" width="612" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">and then you just recover the original message by:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">text2 := from_number(dec2);</font></b>
</p>
<p align="center">
<img src="images/clint_ah45.gif" width="315" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Horrah!! Once again, all </font></b>
<b><u><font color="#000080">SEEMS</font></u></b>
<b><font color="#000080"> fine. But why '</font></b>
<i><b><font color="#000080">seems</font></b></i>
<b><font color="#000080">'?  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Well, at least you </font></b>
<b><u><font color="#000080">know</font></u></b>
<b><font color="#000080"> the message has come from me (since - in theory - ONLY I know MY private key), BUT ANYONE could also read that message.  </font></b>
<b><u><font color="#000080">Anyone</font></u></b>
<b><font color="#000080">, that is, </font></b>
<b><u><font color="#000080">who</font></u></b>
<b><font color="#000080"> (like you) </font></b>
<b><u><font color="#000080">knows my public key</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Of course</font></u></b>
<b><font color="#000080">, </font></b>
<b><u><font color="#000080">if</font></u></b>
<b><font color="#000080"> you had your public and private keys </font></b>
<b><u><font color="#000080">then</font></u></b>
<b><font color="#000080"> that problem could be avoided by my sending you the above message using your public encryption power ... .</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">BUT</font></u></b>
<b><font color="#000080"> then you couldn't be sure the message is from me ... .</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">[I hope you see what the problems are ... .]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">While we are at it - and before showing how all is resolved - I would like to divert briefly to illustrate what happens if someone ATTEMPTS to GUESS my private decryption power, in an attempt to FORGE my signature:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Suppose they wished to send the same message as above, and went through the usual steps:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">NUM2 := to_number(`Can't make it. Too much work. John`);</font></b>
</p>
<p align="center">
<img src="images/clint_ah46.gif" width="627" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Let's say they choose the following </font></b>
<b><u><font color="#000080">forged</font></u></b>
<b><font color="#000080"> value for my </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> decryption power [such an attempt is, of course, </font></b>
<b><u><font color="#000080">doomed</font></u></b>
<b><font color="#000080">. They are trying to find that needle in that haystack!!]:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">DJ_guess := 98877676655544333221110093465439876548765432;</font></b>
</p>
<p align="center">
<img src="images/clint_ah47.gif" width="454" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">and now encrypted</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ENC2 := NUM2&amp;^DJ_guess mod nj;  </font></b>
</p>
<p align="left">
<img src="images/clint_ah48.gif" width="80" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah49.gif" width="960" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">They send you that number, and you now proceed to (attempt to) decrypt it, using my </font></b>
<b><u><font color="#000080">genuine</font></u></b>
<b><font color="#000080"> </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080"> key:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">DEC2 := ENC2&amp;^ej mod nj; </font></b>
</p>
<p align="left">
<img src="images/clint_ah50.gif" width="80" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah51.gif" width="960" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">There is nothing apparently untoward there, but now the game is up when you attempt to recover the original text:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">text2 := from_number(DEC2);</font></b>
</p>
<p align="center">
<img src="images/clint_ah52.gif" width="596" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">The forger would have wasted his/her time</font></u></b>
<b><font color="#000080">. The message decrypts as </font></b>
<i><b><font color="#000080">gobbledegook</font></b></i>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Section Two</font></u></b>
<b><font color="#000080" size="4">.     How the RSA method is used to provide a '</font></b>
<i><b><font color="#000080" size="4">digital signature</font></b></i>
<b><font color="#000080" size="4">.'</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">One of the </font></b>
<b><u><font color="#000080">MAJOR</font></u></b>
<b><font color="#000080"> applications of public-key cryptography is that it allows </font></b>
<b><u><font color="#000080">SECURE</font></u></b>
<b><font color="#000080"> two-way '</font></b>
<b><u><font color="#000080">signed</font></u></b>
<b><font color="#000080">' communication between two parties who each have their own public and private keys (with, of course, an agreed system for converting text into numerical form). [That is what President Clinton and Mr. Ahern were doing in a very public way, but it is exactly what everyone else is doing all the time ... .]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Let us have parties A and B with public and private keys (</font></b>
<i><b><font color="#000080">ea</font></b></i>
<b><font color="#000080">, </font></b>
<i><b><font color="#000080">na</font></b></i>
<b><font color="#000080">, </font></b>
<i><b><font color="#000080">da</font></b></i>
<b><font color="#000080">) and (</font></b>
<i><b><font color="#000080">eb</font></b></i>
<b><font color="#000080">, </font></b>
<i><b><font color="#000080">nb</font></b></i>
<b><font color="#000080">, </font></b>
<i><b><font color="#000080">db</font></b></i>
<b><font color="#000080">); then these parties can communicate securely with each other.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Implicit in all of this - of course - is the assumption that </font></b>
<i><b><font color="#000080">na</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080">nb</font></b></i>
<b><font color="#000080"> have been created so that they </font></b>
<b><u><font color="#000080">cannot</font></u></b>
<b><font color="#000080"> be factored quickly!!.  That will be discussed in final section, Section Three.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">This is how it is done</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">First</font></u></b>
<b><font color="#000080"> let's create public and private keys for A and B [I am not going to be fussy about the choice of primes.  I am merely choosing them to be 'big']:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">I make up the first prime, </font></b>
<i><b><font color="#000080">pa</font></b></i>
<b><font color="#000080">, so that it has 100 digits. Because that can take as much as two minutes to compute [depending on the speed of the computer being used] then to save time in my lecture I have privately calculated it, copied and pasted its value into a new region, and simply that </font></b>
</p>
<p align="left">
<b><font color="#000080">can take a while, depending on the speed of the computer]:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># pa := nextprime(10^99 + 8765432109876543211234567834567);</font></b>
</p>
<p align="left">
<b><font color="#000080">Calculated, copied, pasted, and reexecuted (</font></b>
<b><u><font color="#000080">to save time in lecture</font></u></b>
<b><font color="#000080">):</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">pa := 1000000000000000000000000000000000000000000000000000000000000000000008765432109876543211234567835109;</font></b>
</p>
<p align="center">
<img src="images/clint_ah53.gif" width="854" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">And now for the second prime</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># qa := nextprime(10^119 + 8765432109876543211234567834567);</font></b>
</p>
<p align="left">
<b><font color="#000080">As with </font></b>
<i><b><font color="#000080">pa</font></b></i>
<b><font color="#000080"> this has been calculated, copied, pasted, reexecuted </font></b>
<b><u><font color="#000080">to save time</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">qa := 100000000000000000000000000000000000000000000000000000000000000000000000000000000000000008765432109876543211234567835227;</font></b>
</p>
<p align="left">
<img src="images/clint_ah54.gif" width="54" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah55.gif" width="976" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Now to form A's public modulus</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">na := pa*qa;</font></b>
</p>
<p align="left">
<img src="images/clint_ah56.gif" width="951" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah57.gif" width="872" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Now to choose A's public encryption power</font></u></b>
<b><font color="#000080">, </font></b>
<b><u><font color="#000080">followed by the other standard computations</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ea := nextprime(12321);</font></b>
</p>
<p align="center">
<img src="images/clint_ah58.gif" width="93" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">phi_na := (pa - 1)*(qa - 1);</font></b>
</p>
<p align="left">
<img src="images/clint_ah59.gif" width="957" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah60.gif" width="896" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcdex(ea, phi_na, xa, ya);</font></b>
</p>
<p align="center">
<img src="images/clint_ah61.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">da := xa mod phi_na;</font></b>
</p>
<p align="left">
<img src="images/clint_ah62.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah63.gif" width="864" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Now to do make similar choices and calculations for B</font></u></b>
<b><font color="#000080"> (once again I have saved lecture time by calculating the two primes, copied, pasted, reexecuted):</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># pb := nextprime(10^109 + 2228765432109876543211234567834000); # 110 digits</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">pb := 10000000000000000000000000000000000000000000000000000000000000000000000000002228765432109876543211234567834173;</font></b>
</p>
<p align="center">
<img src="images/clint_ah64.gif" width="934" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># qb := nextprime(10^129 + 2228765432109876543211234567834000); # 130 digits</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">qb := 1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002228765432109876543211234567834077;</font></b>
</p>
<p align="left">
<img src="images/clint_ah65.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah66.gif" width="160" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">nb := pb*qb;</font></b>
</p>
<p align="left">
<img src="images/clint_ah67.gif" width="951" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah68.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah69.gif" width="96" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">eb := nextprime(54321);</font></b>
</p>
<p align="center">
<img src="images/clint_ah70.gif" width="93" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">phi_nb := (pb - 1)*(qb - 1);</font></b>
</p>
<p align="left">
<img src="images/clint_ah71.gif" width="957" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah72.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah73.gif" width="120" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcdex(eb, phi_nb, xb, yb);</font></b>
</p>
<p align="center">
<img src="images/clint_ah74.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">db := xb mod phi_nb;</font></b>
</p>
<p align="left">
<img src="images/clint_ah75.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah76.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah77.gif" width="88" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080" size="5">So, A and B have public and private keys</font></u></b>
<b><font color="#000080" size="5">, </font></b>
<b><font color="#000080" size="5">and we are now in business</font></b>
<b><font color="#000080" size="5">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Let B send the following message, in signed form to A:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">   </font></b>
<i><b><font color="#000080" size="5">If we give you £1,000,000 will we <br>
     get the government contract?</font></b></i>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">For technical mathematical reasons</font></u></b>
<b><font color="#000080"> - that can only be understood by someone who has really studied the </font></b>
<b><font color="#000080">mathematics</font></b>
<b><font color="#000080"> of all of this - </font></b>
<b><u><font color="#000080">one must KEEP IN MIND</font></u></b>
<b><font color="#000080"> that since A's public modulus is </font></b>
<b><u><font color="#000080">LESS</font></u></b>
<b><font color="#000080"> than B's (</font></b>
<i><b><font color="#000080">na</font></b></i>
<b><font color="#000080"> is less than </font></b>
<i><b><font color="#000080">nb</font></b></i>
<b><font color="#000080">), then one must use the </font></b>
<b><u><font color="#000080">SMALLER</font></u></b>
<b><font color="#000080"> modulus </font></b>
<b><u><font color="#000080">FIRST</font></u></b>
<b><font color="#000080"> [this just really means that the order in which the paints are applied is important]:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">The steps are:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">B_num := to_number(`If we give you £1,000,000 will we get the government contract?`); </font></b>
</p>
<p align="left">
<img src="images/clint_ah78.gif" width="951" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah79.gif" width="144" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(B_num);</font></b>
</p>
<p align="center">
<img src="images/clint_ah80.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Because B_num is less than </font></b>
<i><b><font color="#000080">na</font></b></i>
<b><font color="#000080">, then the message can be sent as a </font></b>
<b><u><font color="#000080">single block</font></u></b>
<b><font color="#000080"> (had that not been so, then one would have had to break up the numerical form of the message into blocks of digits, each having numerical value less than </font></b>
<i><b><font color="#000080">na</font></b></i>
<b><font color="#000080">)</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">B now does a </font></u></b>
<b><u><font color="#000080" size="4">double encryption</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">FIRST using A's smaller modulus, with A's PUBLIC encryption power [so, laying on A's public paint],<br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">SECOND using B's own modulus, with B's PRIVATE decryption power [laying on B's own private paint]:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">B_first := B_num&amp;^ea mod na;  # SMALLER modulus FIRST</font></b>
</p>
<p align="left">
<img src="images/clint_ah81.gif" width="956" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah82.gif" width="888" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">B_second := B_first&amp;^db mod nb;</font></b>
</p>
<p align="left">
<img src="images/clint_ah83.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah84.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah85.gif" width="136" height="19" alt="[Maple Math]">
</p>
<p align="left">
<i><b><font color="#000080">B_second</font></b></i>
<b><font color="#000080"> is what A receives, and A now proceeds to do the </font></b>
<b><u><font color="#000080" size="4">double decryption</font></u></b>
<b><font color="#000080"> as follows (simply </font></b>
<b><u><font color="#000080">reversing</font></u></b>
<b><font color="#000080"> the last two steps):</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">FIRST using B's modulus, with B's PUBLIC encryption power [laying on B's public paint], </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">SECOND using A's own modulus, with A's PRIVATE decryption power [laying on A's own private paint]:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">A_first := B_second&amp;^eb mod nb;</font></b>
</p>
<p align="left">
<img src="images/clint_ah86.gif" width="956" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah87.gif" width="888" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">A_second := A_first&amp;^da mod na;</font></b>
</p>
<p align="left">
<img src="images/clint_ah88.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah89.gif" width="160" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number(A_second);</font></b>
</p>
<p align="center">
<img src="images/clint_ah90.gif" width="434" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080">Now let A reply with the message</font></u></b>
<b><font color="#000080">: </font></b>
</p>
<p align="left">
</p>
<p align="left">
<i><b><font color="#000080" size="5">You're joking! £2,000,000 and it's yours. You'll recoup all with contract. <br>
Leave cash usual place.</font></b></i>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">A_num := to_number(`You're joking! £2,000,000 and it's yours.You'll recoup all with contract.  Leave cash usual place.`);</font></b>
</p>
<p align="left">
<img src="images/clint_ah91.gif" width="951" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah92.gif" width="720" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(A_num);</font></b>
</p>
<p align="center">
<img src="images/clint_ah93.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(na);</font></b>
</p>
<p align="center">
<img src="images/clint_ah94.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Again, because </font></b>
<i><b><font color="#000080">A_num</font></b></i>
<b><font color="#000080"> is less than </font></b>
<i><b><font color="#000080">na</font></b></i>
<b><font color="#000080">, then the message can be sent as a </font></b>
<b><u><font color="#000080">single block</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">A_first := A_num&amp;^da mod na;  # SMALLER modulus first</font></b>
</p>
<p align="left">
<img src="images/clint_ah95.gif" width="956" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah96.gif" width="888" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">A_second := A_first&amp;^eb mod nb;</font></b>
</p>
<p align="left">
<img src="images/clint_ah97.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah98.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah99.gif" width="136" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
</p>
<p align="left">
<b><font color="#000080">A_second is what B receives, and B now proceeds to decrypt A's message as follows (simply reversing the last two steps):</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">B_first := A_second&amp;^db mod nb;</font></b>
</p>
<p align="left">
<img src="images/clint_ah100.gif" width="956" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah101.gif" width="888" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">B_second := B_first&amp;^ea mod na;</font></b>
</p>
<p align="left">
<img src="images/clint_ah102.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah103.gif" width="736" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">from_number(B_second);</font></b>
</p>
<p align="center">
<img src="images/clint_ah104.gif" width="658" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Section Three</font></u></b>
<b><font color="#000080" size="4">.   The '</font></b>
<i><b><font color="#000080" size="4">factorization problem</font></b></i>
<b><font color="#000080" size="4">.'</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">A critical observation</font></u></b>
<b><font color="#000080" size="4">.  </font></b>
<b><u><font color="#000080" size="4">You may (indeed, should!) say</font></u></b>
<b><font color="#000080">: </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">&quot;I see how one creates those public and private keys in RSA. One just does the following:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">1.  Choose two primes </font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> and </font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080">, and form their product, </font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">2.  Choose an 'encryprion power' </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080"> (subject to a certain, minor technical constraint).</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">3.  Calculate a 'decryption power' </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080">, </font></b>
<b><u><font color="#000080">in a </font></u></b>
<i><b><u><font color="#000080">very</font></u></b></i>
<b><u><font color="#000080"> particular way</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">4.  Make (</font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">, e) </font></b>
<i><b><u><font color="#000080">public</font></u></b></i>
<i><b><font color="#000080"> </font></b></i>
<b><font color="#000080">but keep </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080"> </font></b>
<i><b><u><font color="#000080">private</font></u></b></i>
<b><font color="#000080">.  </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Surely</font></u></b>
<b><font color="#000080"> that '</font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080">' is </font></b>
<b><u><font color="#000080">not really</font></u></b>
<b><font color="#000080"> private (in the sense of remaining unknown)?</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">Surely</font></u></b>
<b><font color="#000080"> if you knew a person's </font></b>
<i><b><font color="#000080">public</font></b></i>
<i><b><font color="#000080">-key</font></b></i>
<b><font color="#000080"> - their (</font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">, </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080">) pair - you could just perform a certain calculation, and compute the value of their</font></b>
</p>
<p align="left">
<i><b><font color="#000080">private-key</font></b></i>
<b><font color="#000080"> - their </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080"> - and on intercepting any messages sent to them proceed to decrypt the message? &quot;  [end of quote]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">I say to you, show me what you mean</font></u></b>
<b><font color="#000080">, and you might proceed as follows:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">&quot;I know that Maple (say) has a command that '</font></b>
<i><b><font color="#000080">factors</font></b></i>
<b><font color="#000080">' numbers, meaning that it can break any whole number down into its prime constituents. </font></b>
<b><u><font color="#000080">Here are some examples</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(91); </font></b>
</p>
<p align="center">
<img src="images/clint_ah105.gif" width="80" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">which shows that 91 is the product of the primes 7 and 13</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(637);</font></b>
</p>
<p align="center">
<img src="images/clint_ah106.gif" width="89" height="28" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">which shows that 637 is the product of the primes 7, 7 and 13.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">And consider the following:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(509429407491696281);</font></b>
</p>
<p align="center">
<img src="images/clint_ah107.gif" width="200" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">which </font></b>
<b><u><font color="#000080">means</font></u></b>
<b><font color="#000080"> that 509429407491696281 is the product of the primes  </font></b>
<img src="images/clint_ah108.gif" width="88" height="30" alt="[Maple Math]" align="middle">
<b><font color="#000080"> and  </font></b>
<img src="images/clint_ah109.gif" width="88" height="30" alt="[Maple Math]" align="middle">
<b><font color="#000080">, and so </font></b>
<b><u><font color="#000080">if</font></u></b>
<b><font color="#000080"> someone announced their </font></b>
<b><u><font color="#000080">public</font></u></b>
<b><font color="#000080"> (</font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">, </font></b>
<i><b><font color="#000080">e</font></b></i>
<b><font color="#000080">) to be (</font></b>
<img src="images/clint_ah110.gif" width="160" height="30" alt="[Maple Math]" align="middle">
<b><font color="#000080">, </font></b>
<img src="images/clint_ah111.gif" width="48" height="30" alt="[Maple Math]" align="middle">
<b><font color="#000080">), then anyone could calculate that person's </font></b>
<b><u><font color="#000080">private</font></u></b>
<b><font color="#000080"> </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080">, and thus </font></b>
<b><u><font color="#000080">be able to decrypt that person's messages</font></u></b>
<b><font color="#000080">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">One would just do these calculations</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">p := 765432713;</font></b>
</p>
<p align="center">
<img src="images/clint_ah112.gif" width="118" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">q := 665544337;</font></b>
</p>
<p align="center">
<img src="images/clint_ah113.gif" width="118" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">e := 8779;</font></b>
</p>
<p align="center">
<img src="images/clint_ah114.gif" width="77" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">igcdex(e, (p-1)*(q-1), x, y);</font></b>
</p>
<p align="center">
<img src="images/clint_ah115.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">d := x mod (p-1)*(q-1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah116.gif" width="182" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">And that's all there is to it!! Given the value of </font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">, one simply factors it, thus finding the values of the </font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> and the </font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080">, and from that - using the value of </font></b>
</p>
<p align="left">
<b><font color="#000080">(</font></b>
<i><b><font color="#000080">p</font></b></i>
<b><font color="#000080"> - 1)*(</font></b>
<i><b><font color="#000080">q</font></b></i>
<b><font color="#000080"> - 1) - one calculates the value of the </font></b>
<i><b><font color="#000080">d</font></b></i>
<b><font color="#000080">, and that's it.  Decrypt!!&quot;  [end of quote.]</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">I would completely agree with you</font></u></b>
<b><font color="#000080">, but would draw your attention now to the </font></b>
<b><u><font color="#000080">crucial point</font></u></b>
<b><font color="#000080">: </font></b>
<b><font color="#000080" size="5"> all of that depended on your being able to recover the values of those two primes </font></b>
<i><b><font color="#000080" size="5">p</font></b></i>
<b><font color="#000080" size="5"> and </font></b>
<i><b><font color="#000080" size="5">q</font></b></i>
<b><font color="#000080"> </font></b>
<b><font color="#000080" size="5">from the value of </font></b>
<i><b><font color="#000080" size="5">n</font></b></i>
<b><font color="#000080" size="5">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="5">Major point</font></u></b>
<b><font color="#000080" size="5">.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="5">Multiplying</font></u></b>
<b><font color="#000080" size="5"> big numbers isn't a problem</font></b>
</p>
<p align="left">
<b><font color="#000080" size="5">BUT </font></b>
<b><u><font color="#000080" size="5">factoring</font></u></b>
<b><font color="#000080" size="5"> big numbers is!! More precisely,<br>
factoring certain BIG numbers is a problem</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">9999999999999999999999999999988888888888888888888888777777777777777777777777777777777777776666666666666666666666666665555555555555555555555555444444444444444444443333333333333333*2222222222222222222222111111111111111111111111111111000000000000000000000000055555555555555555555555555333333333333333333333333333333333;</font></b>
</p>
<p align="left">
<img src="images/clint_ah117.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah118.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah119.gif" width="656" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(9999999999999999999999999999988888888888888888888888777777777777777777777777777777777777776666666666666666666666666665555555555555555555555555444444444444444444443333333333333333);</font></b>
</p>
<p align="center">
<img src="images/clint_ah120.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(2222222222222222222222111111111111111111111111111111000000000000000000000000055555555555555555555555555333333333333333333333333333333333);</font></b>
</p>
<p align="center">
<img src="images/clint_ah121.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">There we saw that the product of one 178-digit number and a 136-digit number was calculated almost instantly.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Now let us look at a succession of multiplications, and corresponding factorizations:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">p1 := nextprime(38899887766);</font></b>
</p>
<p align="center">
<img src="images/clint_ah122.gif" width="142" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">q1 := nextprime(64466887766);</font></b>
</p>
<p align="center">
<img src="images/clint_ah123.gif" width="142" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">n1 := p1*q1; length(n1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah124.gif" width="231" height="19" alt="[Maple Math]">
</p>
<p align="center">
<img src="images/clint_ah125.gif" width="32" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(n1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah126.gif" width="232" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">p2 := nextprime(738899887766);</font></b>
</p>
<p align="center">
<img src="images/clint_ah127.gif" width="150" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">q2 := nextprime(638899887766);</font></b>
</p>
<p align="center">
<img src="images/clint_ah128.gif" width="150" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">n2 := p2*q2; length(n2);</font></b>
</p>
<p align="center">
<img src="images/clint_ah129.gif" width="247" height="19" alt="[Maple Math]">
</p>
<p align="center">
<img src="images/clint_ah130.gif" width="32" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(n2);</font></b>
</p>
<p align="center">
<img src="images/clint_ah131.gif" width="248" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">p3 := nextprime(5538899887766);</font></b>
</p>
<p align="center">
<img src="images/clint_ah132.gif" width="158" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">q3 := nextprime(3138899887766);</font></b>
</p>
<p align="center">
<img src="images/clint_ah133.gif" width="158" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">n3 := p3*q3; length(n3);</font></b>
</p>
<p align="center">
<img src="images/clint_ah134.gif" width="263" height="19" alt="[Maple Math]">
</p>
<p align="center">
<img src="images/clint_ah135.gif" width="32" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(n3);</font></b>
</p>
<p align="center">
<img src="images/clint_ah136.gif" width="264" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">I </font></b>
<b><u><font color="#000080">could</font></u></b>
<b><font color="#000080"> continue doing those sorts of calculations, each taking a little longer than the previuos one, but I am going to leap forward somewhat to</font></b>
</p>
<p align="left">
<b><font color="#000080">present you with this number - rather a famous one in the literature - </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">                   </font></b>
<b><font color="#000080" size="5">the </font></b>
<i><b><font color="#000080" size="5">'RSA_129</font></b></i>
<b><font color="#000080" size="5">' number</font></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">RSA_129 := 114381625757888867669235779976146612010218296721242362562561842935706935245733897830597123563958705058989075147599290026879543541;</font></b>
</p>
<p align="left">
<img src="images/clint_ah137.gif" width="957" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah138.gif" width="192" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(RSA_129);</font></b>
</p>
<p align="center">
<img src="images/clint_ah139.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">I am certainly </font></b>
<b><u><font color="#000080">NOT</font></u></b>
<b><font color="#000080"> going to attempt to factor it!!</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">It first came to public attention in Martin Gardiner's much read column in the August 1997 issue of the </font></b>
<i><b><font color="#000080">Scientific American</font></b></i>
<b><font color="#000080">. </font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Rivest, Shamir and Adleman (of RSA fame) threw this number out as a challenge to be factored. Given the then state of mathematical knowledge (as far as factoring was concerned) and computer power, they estimated that it would take some 20,000 years to factor it, and thereby decrypt a message which they had encrypted using it as the '</font></b>
<i><b><font color="#000080">n</font></b></i>
<b><font color="#000080">' part of a public modulus.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Briefly, a method known as the 'Quadratic Sieve' - introduced in 1981 by the US mathematician Carl Pomerance - together with thousands of</font></b>
</p>
<p align="left">
<b><font color="#000080">computers worldwide (organised by the Dutch mathematician Arjen Lenstra) - factored it by April 1994, and decrypted the RSA-encrypted</font></b>
</p>
<p align="left">
<b><font color="#000080">message (which, incidentally, was: &quot;</font></b>
<i><b><font color="#000080">The magic words are squeamish ossifrage.</font></b></i>
<b><font color="#000080">&quot;)</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Lenstra, and his co-workers found that </font></b>
<i><b><font color="#000080">RSA_129</font></b></i>
<b><font color="#000080"> was the product of the two prime numbers (I show them individually, then their produst, and then show their product really is RSA_129):</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">f1 := 3490529510847650949147849619903898133417764638493387843990820577;</font></b>
</p>
<p align="center">
<img src="images/clint_ah140.gif" width="563" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(f1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah141.gif" width="32" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">f2 := 32769132993266709549961988190834461413177642967992942539798288533;</font></b>
</p>
<p align="center">
<img src="images/clint_ah142.gif" width="571" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(f2);</font></b>
</p>
<p align="center">
<img src="images/clint_ah143.gif" width="32" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">f1*f2;</font></b>
</p>
<p align="left">
<img src="images/clint_ah144.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah145.gif" width="112" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">RSA_129 - f1*f2;</font></b>
</p>
<p align="center">
<img src="images/clint_ah146.gif" width="24" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">If I were to foolishly enter the Maple command:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># ifactor(RSA_129);</font></b>
</p>
<p align="left">
<b><font color="#000080">then the timer would stay on for MANY, MANY years ... .</font></b>
</p>
<p align="left">
<b><u><font color="#000080" size="4">Question</font></u></b>
<b><font color="#000080" size="4">.  So, it it just a matter of mere size?</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">Answer</font></u></b>
<b><font color="#000080" size="4">. No. Size is only </font></b>
<b><u><font color="#000080" size="4">part</font></u></b>
<b><font color="#000080" size="4"> of the problem:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080">I am going to create a number</font></u></b>
<b><font color="#000080"> - which I will call by the name 'beyond_RSA_129' - which will have these properties:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">it will be the </font></b>
<b><u><font color="#000080">product</font></u></b>
<b><font color="#000080"> of two primes 'P' and 'Q'</font></b>
</p>
<p align="left">
<b><font color="#000080">I will choose P to be f2 (the greater of the two primes whose product is RSA_129)</font></b>
</p>
<p align="left">
<b><font color="#000080">I will choose Q to be greater than P<br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">Those choices will automatically make 'beyond_RSA_129' be greater than RSA_129 (hence the name).</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">This is how I will do it:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">P := f2;</font></b>
</p>
<p align="center">
<img src="images/clint_ah147.gif" width="568" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">I am choosing 'Q' to be next prime after the prime 'P', and to save computation time in my lecture I do this:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># Q := nextprime(P);</font></b>
</p>
<p align="center">
<img src="images/clint_ah148.gif" width="570" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Q := 32769132993266709549961988190834461413177642967992942539798288793;</font></b>
</p>
<p align="center">
<img src="images/clint_ah149.gif" width="570" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">beyond_RSA_129 := P*Q;</font></b>
</p>
<p align="left">
<img src="images/clint_ah150.gif" width="956" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah151.gif" width="256" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(beyond_RSA_129);</font></b>
</p>
<p align="center">
<img src="images/clint_ah152.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">But now I show you that that number can be QUICKLY factored as follows:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Fermat_factor:=proc(n,start,finish)  <br>
local k, s; readlib(issqr):<br>
for k from start to finish do<br>
if issqr(n+k^2) then s:=sqrt(n+k^2); <br>
lprint(n,`factors as the product of`,<br>
s-k,`and`,s+k); RETURN()<br>
fi od end:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Fermat_factor(beyond_RSA_129, 0, 300);</font></b>
</p>
<p align="left">
<b><tt><!--mstheme--></font><pre><font color="#FF0000" size="4">1073816077130400819475486272224340785666856801858501936519539003127821295385023569561686898933064223684576642307425535503474310669   factors as the product of   32769132993266709549961988190834461413177642967992942539798288533   and   32769132993266709549961988190834461413177642967992942539798288793</font></pre><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica"></tt></b>
</p>
<p align="left">
<b><u><font color="#000080">An almost instantaneous factorisation</font></u></b>
<b><font color="#000080">!!</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">How was that possible? It would not be possible to go into the exact details here in a public lecture, but suffice it to say that it involves little more than</font></b>
</p>
<p align="left">
<b><font color="#000080">elementary school work (IF I have time I may ... ).</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">What I </font></b>
<b><u><font color="#000080">will let out</font></u></b>
<b><font color="#000080"> however is that the success was whooly dependant on the </font></b>
<b><u><font color="#000080">CRITICAL</font></u></b>
<b><font color="#000080"> fact that the two primes </font></b>
<b><u><font color="#000080">P and Q</font></u></b>
<b><font color="#000080"> - although large - </font></b>
<b><u><font color="#000080">are relatively close to each other</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Q - P;</font></b>
</p>
<p align="center">
<img src="images/clint_ah153.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">What - though - if one doesn't choose two primes that are relatively close to each other? Suppose one choose them so that they were quite far apart?</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">That's what I'm now going to do.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">This time I will make up another number - I will call it 'way_beyond_RSA_129' - which will have these properties:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">it will be the </font></b>
<b><font color="#000080">product</font></b>
<b><font color="#000080"> of two primes 'P1' and 'Q1'</font></b>
</p>
<p align="left">
<b><font color="#000080">I will still choose P1 to be f2 (the greater of the two primes whose product is RSA_129)</font></b>
</p>
<p align="left">
<b><font color="#000080">I will choose Q1 to be MUCH greater than P1<br>
</font></b>
</p>
<p align="left">
<b><font color="#000080">This is how I will do it:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">P1 := f2;</font></b>
</p>
<p align="center">
<img src="images/clint_ah154.gif" width="576" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">To save computation time in my lecture I do this:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080"># Q1 := nextprime(4470115461512684340891257138125051110076800700282905015819080092370422104067183317016903679999999999999630);</font></b>
</p>
<p align="center">
<img src="images/clint_ah155.gif" width="906" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Q1 := 4470115461512684340891257138125051110076800700282905015819080092370422104067183317016903680000000000000001;</font></b>
</p>
<p align="center">
<img src="images/clint_ah156.gif" width="906" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">way_beyond_RSA_129 := P1*Q1;</font></b>
</p>
<p align="left">
<img src="images/clint_ah157.gif" width="950" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah158.gif" width="624" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">length(way_beyond_RSA_129);</font></b>
</p>
<p align="center">
<img src="images/clint_ah159.gif" width="40" height="19" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">way_beyond_RSA_129 - beyond_RSA_129;</font></b>
</p>
<p align="left">
<img src="images/clint_ah160.gif" width="952" height="19" alt="[Maple Math]">
<br>
<img src="images/clint_ah161.gif" width="448" height="19" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">But that MUCH LARGER number can now be QUICKLY factored by doing this:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Pollard:=proc(n)<br>
local a,k;<br>
a[1]:=2:<br>
for k from 2 while igcd(n,a[k-1]-1 mod n)=1   <br>
do a[k]:=a[k-1]&amp;^k mod n od;<br>
lprint(n,`is the PRODUCT of`,                                                                                                  igcd(n, a[k-1]-1 mod n), `and`, <br>
n/igcd(n, a[k-1]-1 mod n))<br>
end:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">Pollard(way_beyond_RSA_129);</font></b>
</p>
<p align="left">
<b><tt><!--mstheme--></font><pre><font color="#FF0000" size="4">146481808053566948606112326494160580676597757390203425433760346556289969224977192583652803722778590707655656624536558761037114144280380743982554672552469432942539798288533   is the PRODUCT of   4470115461512684340891257138125051110076800700282905015819080092370422104067183317016903680000000000000001   and   32769132993266709549961988190834461413177642967992942539798288533</font></pre><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica"></tt></b>
</p>
<p align="left">
<b><u><font color="#000080">WONDERFUL!!!</font></u></b>
</p>
<p align="left">
<b><font color="#000080">The mathematical ideas behind the success of that factorisation are due to a British mathematician called John Pollard (he lives outside Reading), and were published by him in 1974 in the Mathematical Proceedings of the Cambridge Philosophical Society, in a now famous paper. The method he develops there has become known as 'Pollard's </font></b>
<b><u><font color="#000080">p - 1 method</font></u></b>
<b><font color="#000080">', and with reason:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">In that paper he expounds a very beautiful idea which enables one to factor a number, one of whose prime factors 'p' </font></b>
<b><u><font color="#000080">is such that</font></u></b>
<b><font color="#000080"> the number p - 1 has only </font></b>
<b><u><font color="#000080">SMALL</font></u></b>
<b><font color="#000080"> prime factors.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">That is WHY I was able so quickly to factor the number 'way_beyond_RSA_129. Look at how its prime factor Q1 is </font></b>
<b><u><font color="#000080">structured</font></u></b>
<b><font color="#000080">:</font></b>
</p>
<p align="left">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(Q1 - 1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah162.gif" width="909" height="28" alt="[Maple Math]">
</p>
<p align="left">
<b><font color="#000080">Look at all those SMALL primes: 2, 3, 5, ... , 71 and 73.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">I'll let you in on my secret. No, I won't. It would spoil the fun (though some of you may see ... ).</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><font color="#000080">Whereas look at the two prime factors - f1 and f2 - of the RSA_129 number; see how they behave:</font></b>
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(f1 - 1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah163.gif" width="608" height="28" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
<b><font color="#800080">ifactor(f2 - 1);</font></b>
</p>
<p align="center">
<img src="images/clint_ah164.gif" width="615" height="28" alt="[Maple Math]">
</p>
<p align="left">
<tt>&gt; </tt>
</p>
<p align="left">
<b><font color="#000080">Rivest, Shamir and Adleman knew what they were doing in choosing their two primes to make up their 129 digit number.</font></b>
</p>
<p align="left">
</p>
<p align="left">
<b><u><font color="#000080" size="4">An attempt at a summary</font></u></b>
<b><font color="#000080" size="4">. The current security of the RSA method rests on the </font></b>
<b><u><font color="#000080" size="4">general difficulty of factorisation</font></u></b>
<b><font color="#000080" size="4"> ... .<br>
Besides the Pollard p-1 method there is also his </font></b>
<i><b><font color="#000080" size="4">rho-</font></b></i>
<b><font color="#000080" size="4">method aka his </font></b>
<i><b><font color="#000080" size="4">Monte Carlo</font></b></i>
<b><font color="#000080" size="4"> method), and there is the Pomerance<br>
</font></b>
<i><b><font color="#000080" size="4">quadratic sieve </font></b></i>
<b><font color="#000080" size="4">method, Hendrik Lenstra's </font></b>
<i><b><font color="#000080" size="4">elliptic curve</font></b></i>
<b><font color="#000080" size="4"> method, and the current dominant method - the </font></b>
<i><b><font color="#000080" size="4">Number Field Sieve </font></b></i>
<b><font color="#000080" size="4">method (introduced by Pollard, and added to by many others)<br>
<br>
I hope there is enough here for someone who has not been at my public talk to be able to follow this.<br>
<br>
Details concerning the Fermat factorisation method, and the Pollard 'p-1' method, may be seen in Maple<br>
worksheets of mine which are available off the Web at the US Naval Academy on David Joyner's:<br>
<br>
     http://web.usna.navy.mil/~wdj/crypto.htm<br>
<br>
When my College has its own Web site [added October 1999: it now does] I will make many more such Maple documents available.<br>
<br>
Finally, all of the above, and much, much more besides, is studied by my 3rd. year B.Ed. and B.A. students in their </font></b>
<i><b><font color="#000080" size="4">Number Theory and Cryptography</font></b></i>
<b><font color="#000080" size="4"> course here in St. Patrick's College.</font></b>
</p>
<p align="left">
<b><font color="#000080" size="4">                      ______________________</font></b>
</p>
<p align="left">
</p>
<p align="left">
</p>
<!--mstheme--></font><!--msnavigation--></td><td valign="top" width="24"></td><td valign="top" width="1%"><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica">

<!--mstheme--></font></td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><!--mstheme--><font face="Trebuchet MS, Arial, Helvetica">

<p><big>Contact details&nbsp;</big></p>

<p>After August 31st 2007 please use the
following Gmail address: jbcosgrave at gmail.com
</p>

<!--msthemeseparator--><p align="center"><img src="../../../_themes/nature/narule.gif" width="600" height="10"></p>

<p>This page was last updated 18 February 2005 15:08:31 -0000</p>
<!--mstheme--></font></td></tr><!--msnavigation--></table></body>
</html>
